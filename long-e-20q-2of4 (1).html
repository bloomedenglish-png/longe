<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Long E — 20 Questions (2 correct per question)</title>
  <style>
    :root{
      --bg:#f7f7f8; --panel:#fff; --ink:#111827; --muted:#6b7280;
      --ok:#16a34a; --bad:#dc2626; --focus:#3b82f6; --border:#e5e7eb;
      --chip:#f3f4f6;
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0; background:var(--bg); color:var(--ink);
      font:16px/1.55 system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, Noto Sans, Helvetica, Arial;
      display:flex; align-items:center; justify-content:center; padding:24px;
    }
    .wrap{ width:min(900px,100%); }
    .card{
      background:var(--panel); border:1px solid var(--border); border-radius:16px;
      box-shadow:0 6px 20px rgba(0,0,0,.06); padding:28px;
    }
    h1{ margin:0 0 6px; font-size:clamp(20px,3.2vw,28px); }
    p.lead{ margin:0 0 18px; color:var(--muted); }
    .meta{ display:flex; gap:12px; align-items:center; color:var(--muted); margin:8px 0 0; }
    .badge{ background:#eef2ff; border:1px solid #e5e7eb; padding:4px 8px; border-radius:999px; font-weight:700; font-size:13px; color:#3730a3; }
    .qbox{ margin:14px 0 6px; padding:14px; background:#fafafa; border:1px solid var(--border); border-radius:12px; }
    .grid{
      display:grid; gap:10px;
      grid-template-columns: repeat(auto-fit, minmax(160px, 1fr));
      margin:12px 0 6px;
    }
    button.choice{
      padding:14px 12px; border-radius:12px; border:1px solid var(--border);
      background:var(--chip); cursor:pointer; font-weight:800; font-size:18px;
    }
    button.choice:focus-visible{ outline:3px solid var(--focus); outline-offset:2px; }
    button.choice[disabled]{ opacity:.8; cursor:not-allowed; }
    .choice.sel{ border-color:#a5b4fc; background:#eef2ff; }
    .choice.ok{ background:#ecfdf5; border-color:#bbf7d0; }
    .choice.bad{ background:#fef2f2; border-color:#fecaca; }
    .msg{ min-height:1.5em; font-weight:700; margin:8px 0 0; }
    .msg.ok{ color:var(--ok); }
    .msg.bad{ color:var(--bad); }
    footer{
      display:flex; align-items:center; justify-content:space-between; flex-wrap:wrap;
      gap:10px; color:var(--muted); margin-top:14px;
    }
    .score{ font-weight:800; color:var(--ink); }
    .controls{ display:flex; gap:10px; }
    .btn{
      padding:10px 14px; border:1px solid var(--border); background:#fff; border-radius:10px; cursor:pointer; font-weight:600;
    }
    .btn:hover{ filter:brightness(.98); }
    .sr-only{ position:absolute; left:-9999px; width:1px; height:1px; overflow:hidden; }
  </style>
</head>
<body>
  <main class="wrap">
    <section class="card" role="region" aria-labelledby="t">
      <h1 id="t">Long E — Pick the 2 words</h1>
      <p class="lead">Each question has <strong>4 words</strong>. Click the <strong>2 words</strong> with the long e sound /ē/ (like <em>see</em>). There are <strong>20 questions</strong>.</p>

      <div class="meta">
        <span class="badge" id="qnum">Q 1/20</span>
        <span class="badge" id="progress">0 correct</span>
        <span class="badge" id="picked">Picked 0/2</span>
      </div>

      <div class="qbox">
        <h2 class="sr-only" id="qLabel">Pick the two words with long e</h2>
        <div class="grid" id="choices" role="group" aria-labelledby="qLabel"></div>
        <div id="feedback" class="msg" aria-live="polite" aria-atomic="true"></div>
      </div>

      <footer>
        <div class="score" aria-live="polite" aria-atomic="true">Score: <span id="score">0/20</span></div>
        <div class="controls">
          <button id="check" class="btn" type="button" disabled>Check</button>
          <button id="next" class="btn" type="button" disabled>Next</button>
          <button id="restart" class="btn" type="button">Restart</button>
        </div>
      </footer>
    </section>
  </main>

  <script>
    // ====== User Vocabulary (fixed: "be" and "eat" are separate words) ======
    const VOCAB = [
      "he","she","we","be","eat","each","team","read (present tense)","leave","easy","seat","teach","see","keep","feel","week","free","meet","sleep","street"
    ];
    const LONG_E = new Set([
      "he","she","we","be","eat","each","team","read (present tense)","leave","easy","seat","teach","see","keep","feel","week","free","meet","sleep","street"
    ]);

    // We still need 2 non-long-e distractors per question to meet the "2 of 4" requirement.
    const EXTRA_DISTRACTORS = ["bed","pen","red","step","let","men","best","well","ten","hen","cat","sun"];

    const QUESTIONS_COUNT = 20;
    const OPTIONS_PER_Q = 4;
    const TARGETS_PER_Q = 2;

    const WRONG_FEEDBACK = [
      "Not quite. Try again.",
      "Still not it — give it another shot."
    ];

    // ====== State ======
    let wrongIndex = 0;
    let currentIndex = 0;
    let score = 0;
    let questions = []; // [{options:[...], key:Set(correct indices)}]
    let picked = new Set();
    let locked = false;

    // ====== Helpers ======
    function shuffle(arr){
      for(let i=arr.length-1;i>0;i--){
        const j = Math.floor(Math.random()*(i+1));
        [arr[i],arr[j]]=[arr[j],arr[i]];
      }
    }
    function sample(arr, n){
      const copy = [...arr]; shuffle(copy); return copy.slice(0, n);
    }
    function setFeedback(ok, textOk="Pick 2 words with long e."){
      const fb = document.getElementById('feedback');
      fb.textContent = ok ? textOk : WRONG_FEEDBACK[(wrongIndex++) % WRONG_FEEDBACK.length];
      fb.className = "msg " + (ok ? "ok" : "bad");
    }
    function updateHUD(){
      document.getElementById('qnum').textContent = "Q " + (currentIndex+1) + "/" + QUESTIONS_COUNT;
      document.getElementById('score').textContent = score + "/" + QUESTIONS_COUNT;
      document.getElementById('progress').textContent = score + " correct";
      document.getElementById('picked').textContent = "Picked " + picked.size + "/2";
      document.getElementById('check').disabled = picked.size !== TARGETS_PER_Q;
    }

    // ====== Build Questions ======
    function buildOneQuestion(){
      // pick 2 long-e targets from VOCAB
      const longEArray = [...LONG_E];
      const targets = sample(longEArray, TARGETS_PER_Q);

      // pick 2 distractors from extras (guaranteed not long-e)
      const distractors = sample(EXTRA_DISTRACTORS, OPTIONS_PER_Q - TARGETS_PER_Q);

      const options = [...targets, ...distractors];
      shuffle(options);
      const key = new Set();
      options.forEach((w, idx)=>{ if(LONG_E.has(w)) key.add(idx); });
      return {options, key};
    }

    function buildQuestions(){
      questions = Array.from({length: QUESTIONS_COUNT}, buildOneQuestion);
    }

    // ====== Render ======
    function renderQuestion(){
      locked = false;
      picked.clear();
      const box = document.getElementById('choices');
      box.innerHTML = "";
      const q = questions[currentIndex];
      q.options.forEach((word, idx)=>{
        const btn = document.createElement('button');
        btn.className = "choice";
        btn.type = "button";
        btn.textContent = word;
        btn.addEventListener('click', ()=>{
          if(locked) return;
          if(picked.has(idx)){
            picked.delete(idx);
            btn.classList.remove('sel');
          }else{
            if(picked.size >= TARGETS_PER_Q) return; // enforce 2 picks
            picked.add(idx);
            btn.classList.add('sel');
          }
          updateHUD();
        });
        box.appendChild(btn);
      });
      document.getElementById('next').disabled = true;
      setFeedback(true, "Pick 2 words with long e.");
      updateHUD();
    }

    // ====== Check ======
    document.getElementById('check').addEventListener('click', ()=>{
      if(locked) return;
      const q = questions[currentIndex];
      locked = true;
      let allCorrect = (picked.size === q.key.size) && [...picked].every(i => q.key.has(i));
      const btns = [...document.querySelectorAll('.choice')];
      btns.forEach((b, idx)=>{
        b.disabled = true;
        if(q.key.has(idx) && picked.has(idx)){
          b.classList.add('ok');
        }else if(q.key.has(idx) && !picked.has(idx)){
          b.classList.add('ok'); // show correct
        }else if(!q.key.has(idx) && picked.has(idx)){
          b.classList.add('bad');
        }
      });
      if(allCorrect){
        score += 1;
        setFeedback(true, "Correct — those are the two long e words.");
      }else{
        setFeedback(false);
      }
      document.getElementById('next').disabled = false;
      updateHUD();
    });

    // ====== Next / Restart ======
    document.getElementById('next').addEventListener('click', ()=>{
      if(currentIndex < QUESTIONS_COUNT-1){
        currentIndex += 1;
        renderQuestion();
      }else{
        setFeedback(true, "All done! You scored " + score + "/" + QUESTIONS_COUNT + ".");
        document.getElementById('next').disabled = true;
        document.getElementById('check').disabled = true;
      }
    });

    document.getElementById('restart').addEventListener('click', ()=>{
      wrongIndex = 0;
      currentIndex = 0;
      score = 0;
      buildQuestions();
      renderQuestion();
    });

    // ====== Init ======
    buildQuestions();
    renderQuestion();
  </script>
</body>
</html>
